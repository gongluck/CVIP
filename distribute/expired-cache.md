# 过期缓存

- [过期缓存](#过期缓存)
  - [缓存](#缓存)
  - [缓存更新](#缓存更新)

## 缓存

- 缓存提升性能的幅度，不只取决于存储介质的速度，还取决于缓存命中率。
- 为了提高命中率，缓存会基于时间、空间两个维度更新数据。在时间上可以采用LRU、FIFO等算法淘汰数据，而在空间上则可以预读、合并连续的数据。

## 缓存更新

- 缓存数据的添加或者更新，由用户请求触发的，这往往可以带来更高的命中率。
- 当读请求完成后，将读出的内容放入缓存，基于时间局部性原理，有很高的概率被后续的读请求命中。
- 对于磁盘操作，还可以基于空间局部性原理，采用预读算法添加缓存数据。
- 写请求也可以更新缓存，参考[write through和write back](./cap#舍弃一致性提升性能)方式。write back采用异步调用回写数据，能通过批量处理提升性能。
- 由于缓存服务的性能远大于上游应用，一旦大流量穿透失效的缓存到达上游后，就可能压垮应用。Nginx作为HTTP缓存使用时，可以打开合并回源功能，减轻上游压力。在上游应用宕机后，还可以使用过期缓存为用户提供降级服务。
